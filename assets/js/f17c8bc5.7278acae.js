"use strict";(self.webpackChunk_elizaos_docs=self.webpackChunk_elizaos_docs||[]).push([[38584],{22572:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>h,frontMatter:()=>r,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"plugins/solana-v2","title":"Solana Plugin V2 for Eliza \ud83c\udf1f","description":"The Solana Plugin V2 leverages the latest features of @solana/web3.js v2 to provide a modern, efficient, and composable solution for Solana integrations within the Eliza AI agent framework.","source":"@site/packages/plugins/solana-v2.md","sourceDirName":"plugins","slug":"/plugins/solana-v2","permalink":"/packages/plugins/solana-v2","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"defaultSidebar","previous":{"title":"Plugin Solana AgentKit","permalink":"/packages/plugins/solana-agentkit"},"next":{"title":"@elizaos/plugin-solana","permalink":"/packages/plugins/solana"}}');var s=i(31085),a=i(71184);const r={},l="Solana Plugin V2 for Eliza \ud83c\udf1f",o={},c=[{value:"Key Features \ud83d\ude80",id:"key-features-",level:2},{value:"Modern JavaScript and Functional Architecture",id:"modern-javascript-and-functional-architecture",level:3},{value:"Compatibility with existing solana V1 plugins",id:"compatibility-with-existing-solana-v1-plugins",level:3},{value:"Common Utilities",id:"common-utilities",level:3},{value:"<code>sendTransaction</code>",id:"sendtransaction",level:4},{value:"Trusted Execution Environment (TEE)",id:"trusted-execution-environment-tee",level:4},{value:"Current Functionality \ud83c\udfaf",id:"current-functionality-",level:2},{value:"Liquidity Position Management",id:"liquidity-position-management",level:3},{value:"How to run the Orca LP Management tool",id:"how-to-run-the-orca-lp-management-tool",level:3},{value:"1. Set up your environment variables",id:"1-set-up-your-environment-variables",level:4},{value:"2. RPC requirements",id:"2-rpc-requirements",level:4},{value:"3. Update the agent",id:"3-update-the-agent",level:4},{value:"4. Use LP Manager character",id:"4-use-lp-manager-character",level:4},{value:"5. Install and build the repo",id:"5-install-and-build-the-repo",level:4},{value:"5. Run the agent",id:"5-run-the-agent",level:4},{value:"6. Start prompting",id:"6-start-prompting",level:4},{value:"7. Other configurations",id:"7-other-configurations",level:4},{value:"Future Functionality \ud83d\udd2e",id:"future-functionality-",level:2},{value:"Position Management Enhancements",id:"position-management-enhancements",level:3},{value:"Token Launches",id:"token-launches",level:3},{value:"Contributing \ud83e\udd1d",id:"contributing-",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"solana-plugin-v2-for-eliza-",children:"Solana Plugin V2 for Eliza \ud83c\udf1f"})}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.strong,{children:"Solana Plugin V2"})," leverages the latest features of ",(0,s.jsx)(n.code,{children:"@solana/web3.js"})," v2 to provide a modern, efficient, and composable solution for Solana integrations within the Eliza AI agent framework."]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"key-features-",children:"Key Features \ud83d\ude80"}),"\n",(0,s.jsx)(n.h3,{id:"modern-javascript-and-functional-architecture",children:"Modern JavaScript and Functional Architecture"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"@solana/web3.js v2"})," introduces:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Tree-shakability"}),"\n",(0,s.jsx)(n.li,{children:"Composable internals"}),"\n",(0,s.jsx)(n.li,{children:"Zero-dependency design"}),"\n",(0,s.jsx)(n.li,{children:"Functional programming approach"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"compatibility-with-existing-solana-v1-plugins",children:"Compatibility with existing solana V1 plugins"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["This plugin can be used by the agent alongside existing plugins that use ",(0,s.jsx)(n.code,{children:"@solana/web3.js"})," v1."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"common-utilities",children:"Common Utilities"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"Utils"})," class provides shared functionality across the plugin, offering flexibility and ease of integration."]}),"\n",(0,s.jsx)(n.h4,{id:"sendtransaction",children:(0,s.jsx)(n.code,{children:"sendTransaction"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Accepts the RPC instance, transaction instructions, and a wallet."}),"\n",(0,s.jsx)(n.li,{children:"Utilizes Solana's Compute Budget Program for optimized CU usage and priority fees."}),"\n",(0,s.jsx)(n.li,{children:"Implements client-side retry logic to enhance transaction landing success."}),"\n",(0,s.jsxs)(n.li,{children:["More details on optimizing transactions can be found ",(0,s.jsx)(n.a,{href:"https://orca-so.github.io/whirlpools/Whirlpools%20SDKs/Whirlpools/Send%20Transaction",children:"here"}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"trusted-execution-environment-tee",children:"Trusted Execution Environment (TEE)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["For Trusted Execution Environment (TEE) functionality, this plugin transitions from ",(0,s.jsx)(n.code,{children:"Keypair"})," (used in v1) to ",(0,s.jsx)(n.code,{children:"CryptoKeyPair"})," from the Web Crypto API. This change aligns with ",(0,s.jsx)(n.code,{children:"@solana/web3.js"})," v2's zero-dependency, modern JavaScript architecture."]}),"\n",(0,s.jsxs)(n.li,{children:["A modified implementation for TEE integration is included in ",(0,s.jsx)(n.code,{children:"src/utils/"}),", following the same patterns used in ",(0,s.jsx)(n.code,{children:"plugin-tee"}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"current-functionality-",children:"Current Functionality \ud83c\udfaf"}),"\n",(0,s.jsx)(n.h3,{id:"liquidity-position-management",children:"Liquidity Position Management"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Reposition Liquidity"}),":","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Automatically repositions Orca liquidity positions if the center price of the position deviates from the current pool price by more than a user-specified threshold (",(0,s.jsx)(n.code,{children:"repositionThresholdBps"}),")."]}),"\n",(0,s.jsx)(n.li,{children:"Maintains the original width of the position during repositioning."}),"\n",(0,s.jsx)(n.li,{children:"Repositions at a user defined time interval."}),"\n",(0,s.jsx)(n.li,{children:"Uses a slippage tolerance set by the user."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"how-to-run-the-orca-lp-management-tool",children:"How to run the Orca LP Management tool"}),"\n",(0,s.jsx)(n.h4,{id:"1-set-up-your-environment-variables",children:"1. Set up your environment variables"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["In the root of the repositorty, copy ",(0,s.jsx)(n.code,{children:".env.example"})," to ",(0,s.jsx)(n.code,{children:".env"})]}),"\n",(0,s.jsxs)(n.li,{children:["Fill in the following parameters:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"SOLANA_PRIVATE_KEY"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"SOLANA_PUBLIC_KEY"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"SOLANA_RPC_URL"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"OPENAI_API_KEY"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"2-rpc-requirements",children:"2. RPC requirements"}),"\n",(0,s.jsx)(n.p,{children:"Most often, free-tier RPC URLs are not sufficient for this plugin."}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Eliza needs to fetch all your token-accounts in order to find the position NFTs that represent Orca positions. Such calls are done through the ",(0,s.jsx)(n.code,{children:"getProgramAccounts"})," method of the RPC client, which can be expensive."]}),"\n",(0,s.jsxs)(n.li,{children:["To ensure transaction landing, the plugin makes use of a client-side retry logic (read more ",(0,s.jsx)(n.a,{href:"https://www.helius.dev/blog/how-to-land-transactions-on-solana#how-do-i-land-transactions",children:"here"}),"), which also puts a heavier load on the RPC."]}),"\n",(0,s.jsx)(n.li,{children:"The amount of positions you own and the update interval you set can also contribute to RPC limits."}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"3-update-the-agent",children:"3. Update the agent"}),"\n",(0,s.jsxs)(n.p,{children:["In ",(0,s.jsx)(n.code,{children:"agent/src/index.ts"}),", search for the function ",(0,s.jsx)(n.code,{children:"createAgent"}),", and add ",(0,s.jsx)(n.code,{children:"solana_plugin_v2"})," to the ",(0,s.jsx)(n.code,{children:"AgentRuntime"})," like so:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:'export async function createAgent(\n    character: Character,\n    db: IDatabaseAdapter,\n    cache: ICacheManager,\n    token: string\n): Promise<AgentRuntime> {\n    // Rest of the code ...\n\n    return new AgentRuntime({\n        // Other parameters\n        plugins: [\n            // Other plutins\n            getSecret(character, "SOLANA_PUBLIC_KEY") ||\n            (getSecret(character, "WALLET_PUBLIC_KEY") &&\n                !getSecret(character, "WALLET_PUBLIC_KEY")?.startsWith("0x"))\n                ? solanaPluginV2\n                : null,\n    // Rest of the code\n'})}),"\n",(0,s.jsx)(n.h4,{id:"4-use-lp-manager-character",children:"4. Use LP Manager character"}),"\n",(0,s.jsxs)(n.p,{children:["Copy ",(0,s.jsx)(n.code,{children:"packages/plugin-solana-v2/src/character/orca/lpmanager.character.json"})," to ",(0,s.jsx)(n.code,{children:"characters/lpmanager.character.json"}),"."]}),"\n",(0,s.jsx)(n.h4,{id:"5-install-and-build-the-repo",children:"5. Install and build the repo"}),"\n",(0,s.jsx)(n.p,{children:"Follow the general installation and build steps from the README in the root of the repo"}),"\n",(0,s.jsx)(n.h4,{id:"5-run-the-agent",children:"5. Run the agent"}),"\n",(0,s.jsx)(n.p,{children:"Start the agent with the following command:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:'bun start --characters="characters/lpmanager.character.json"\n'})}),"\n",(0,s.jsxs)(n.p,{children:["Visit ",(0,s.jsx)(n.a,{href:"https://localhost:3000",children:"https://localhost:3000"})," to interact with your agent through a web interface."]}),"\n",(0,s.jsx)(n.h4,{id:"6-start-prompting",children:"6. Start prompting"}),"\n",(0,s.jsx)(n.p,{children:"Ask the agent what it can do for you. Provide the appropriate parameters and let the agent reposition your positions automatically."}),"\n",(0,s.jsx)(n.h4,{id:"7-other-configurations",children:"7. Other configurations"}),"\n",(0,s.jsxs)(n.p,{children:["In ",(0,s.jsx)(n.code,{children:"packages/plugin-solana-v2/src/utils/sendTransaction.ts"}),", you can set the priority fees. They are by default set to use the dynamic fees, but you can adjust this as you like."]}),"\n",(0,s.jsx)(n.h2,{id:"future-functionality-",children:"Future Functionality \ud83d\udd2e"}),"\n",(0,s.jsx)(n.h3,{id:"position-management-enhancements",children:"Position Management Enhancements"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Opening and Closing Positions"}),":","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Expose opening and closing positions as separate actions."}),"\n",(0,s.jsx)(n.li,{children:"Allow agents to leverage data streams and other plugins for decision-making and yield optimization."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"token-launches",children:"Token Launches"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Token Creation and Liquidity Setup"}),":","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Create tokens with metadata using the Token 2022 Program."}),"\n",(0,s.jsx)(n.li,{children:"Launch tokens on Orca with single-sided liquidity."}),"\n",(0,s.jsx)(n.li,{children:"Configure start and maximum prices for initial liquidity."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"contributing-",children:"Contributing \ud83e\udd1d"}),"\n",(0,s.jsxs)(n.p,{children:["Contributions are welcome! If you wish to extend ",(0,s.jsx)(n.code,{children:"plugin-solana-v2"})," with your tools, ensure compatibility with ",(0,s.jsx)(n.code,{children:"@solana/web3.js"})," v2."]}),"\n",(0,s.jsx)(n.hr,{})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},71184:(e,n,i)=>{i.d(n,{R:()=>r,x:()=>l});var t=i(14041);const s={},a=t.createContext(s);function r(e){const n=t.useContext(a);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),t.createElement(a.Provider,{value:n},e.children)}}}]);