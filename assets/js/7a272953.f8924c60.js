"use strict";(self.webpackChunk_elizaos_docs=self.webpackChunk_elizaos_docs||[]).push([[67605],{45867:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>o,contentTitle:()=>s,default:()=>h,frontMatter:()=>a,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"plugins/tee","title":"@elizaos/plugin-tee","description":"A plugin for handling Trusted Execution Environment (TEE) operations, providing secure key derivation and remote attestation capabilities.","source":"@site/packages/plugins/tee.md","sourceDirName":"plugins","slug":"/plugins/tee","permalink":"/packages/plugins/tee","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"defaultSidebar","previous":{"title":"tee-verifiable-log","permalink":"/packages/plugins/tee-verifiable-log"},"next":{"title":"ai16z/plugin-thirdweb","permalink":"/packages/plugins/thirdweb"}}');var t=i(31085),l=i(71184);const a={},s="@elizaos/plugin-tee",o={},c=[{value:"Overview",id:"overview",level:2},{value:"Installation",id:"installation",level:2},{value:"Configuration",id:"configuration",level:2},{value:"Usage",id:"usage",level:2},{value:"Features",id:"features",level:2},{value:"DeriveKeyProvider",id:"derivekeyprovider",level:3},{value:"RemoteAttestationProvider",id:"remoteattestationprovider",level:3},{value:"Development",id:"development",level:2},{value:"Requirements",id:"requirements",level:3},{value:"Create a TEE Project Starter",id:"create-a-tee-project-starter",level:3},{value:"Authenticate Your Phala Cloud Account",id:"authenticate-your-phala-cloud-account",level:3},{value:"Build and Publish Docker Image",id:"build-and-publish-docker-image",level:3},{value:"Generate Docker Compose File",id:"generate-docker-compose-file",level:3},{value:"Deploy to Phala Cloud",id:"deploy-to-phala-cloud",level:3},{value:"Upgrade Agent in Phala Cloud",id:"upgrade-agent-in-phala-cloud",level:3},{value:"Get Agent&#39;s Remote Attestation Report",id:"get-agents-remote-attestation-report",level:3},{value:"Local Development",id:"local-development",level:2},{value:"Dependencies",id:"dependencies",level:2},{value:"API Reference",id:"api-reference",level:2},{value:"Actions",id:"actions",level:3},{value:"Providers",id:"providers",level:3},{value:"Services",id:"services",level:3},{value:"Types",id:"types",level:3},{value:"Future Enhancements",id:"future-enhancements",level:2},{value:"Contributing",id:"contributing",level:2},{value:"Credits",id:"credits",level:2},{value:"License",id:"license",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"elizaosplugin-tee",children:"@elizaos/plugin-tee"})}),"\n",(0,t.jsx)(n.p,{children:"A plugin for handling Trusted Execution Environment (TEE) operations, providing secure key derivation and remote attestation capabilities."}),"\n",(0,t.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,t.jsx)(n.p,{children:"This plugin provides functionality to:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Generate secure keys within a TEE environment"}),"\n",(0,t.jsx)(n.li,{children:"Derive Ed25519 keypairs for Solana"}),"\n",(0,t.jsx)(n.li,{children:"Derive ECDSA keypairs for Ethereum"}),"\n",(0,t.jsx)(n.li,{children:"Generate remote attestation quotes"}),"\n",(0,t.jsx)(n.li,{children:"Manage wallet interactions with TEE-derived keys"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"installation",children:"Installation"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"npm install @elizaos/plugin-tee\n"})}),"\n",(0,t.jsx)(n.h2,{id:"configuration",children:"Configuration"}),"\n",(0,t.jsx)(n.p,{children:"The plugin requires the following environment variables:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-env",children:"TEE_MODE=LOCAL|DOCKER|PRODUCTION\nWALLET_SECRET_SALT=your_secret_salt  # Required for single agent deployments\nTEE_VENDOR=phala # Phala Cloud supported only currently\n"})}),"\n",(0,t.jsx)(n.h2,{id:"usage",children:"Usage"}),"\n",(0,t.jsx)(n.p,{children:"Import and register the plugin in your Eliza configuration:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"import { teePlugin } from '@elizaos/plugin-tee';\n\nexport default {\n  plugins: [teePlugin],\n  // ... other configuration\n};\n"})}),"\n",(0,t.jsx)(n.h2,{id:"features",children:"Features"}),"\n",(0,t.jsx)(n.h3,{id:"derivekeyprovider",children:"DeriveKeyProvider"}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"DeriveKeyProvider"})," allows for secure key derivation within a TEE environment:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"import { DeriveKeyProvider } from '@elizaos/plugin-tee';\n\n// Initialize the provider\nconst provider = new DeriveKeyProvider();\n\n// Derive a raw key\nconst rawKey = await provider.rawDeriveKey('/path/to/derive', 'subject-identifier');\n// rawKey is a DeriveKeyResponse that can be used for further processing\nconst rawKeyArray = rawKey.asUint8Array();\n\n// Derive a Solana keypair (Ed25519)\nconst solanaKeypair = await provider.deriveEd25519Keypair('/path/to/derive', 'subject-identifier');\n\n// Derive an Ethereum keypair (ECDSA)\nconst evmKeypair = await provider.deriveEcdsaKeypair('/path/to/derive', 'subject-identifier');\n"})}),"\n",(0,t.jsx)(n.h3,{id:"remoteattestationprovider",children:"RemoteAttestationProvider"}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"RemoteAttestationProvider"})," generates remote attestations within a TEE environment:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"import { RemoteAttestationProvider } from '@elizaos/plugin-tee';\n\nconst provider = new RemoteAttestationProvider();\nconst attestation = await provider.generateAttestation('your-report-data');\n"})}),"\n",(0,t.jsx)(n.h2,{id:"development",children:"Development"}),"\n",(0,t.jsx)(n.h3,{id:"requirements",children:"Requirements"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"https://www.docker.com/products/docker-desktop/",children:"Docker Desktop"})," installed"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"https://cloud.phala.network",children:"Phala Cloud Account"})," ",(0,t.jsx)(n.a,{href:"https://docs.phala.network/phala-cloud/phala-cloud-user-guides/advanced-deployment-options/start-from-cloud-cli#generate-a-phala-cloud-api-key",children:"Generate API Key"})]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"create-a-tee-project-starter",children:"Create a TEE Project Starter"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"elizaos create tee-agent --tee\n"})}),"\n",(0,t.jsx)(n.h3,{id:"authenticate-your-phala-cloud-account",children:"Authenticate Your Phala Cloud Account"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# cd into directory and authenticate your Phala Cloud API Key\ncd tee-agent\nelizaos tee phala auth login\n"})}),"\n",(0,t.jsx)(n.h3,{id:"build-and-publish-docker-image",children:"Build and Publish Docker Image"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Log into Docker and ensure docker is running\nelizaos tee phala docker build\n\n# Publish the Docker image you built\nelizaos tee phala docker push\n"})}),"\n",(0,t.jsx)(n.h3,{id:"generate-docker-compose-file",children:"Generate Docker Compose File"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Generate a Docker Compose file or update the image in the existing docker compose file\nelizaos tee phala docker generate --template eliza\n"})}),"\n",(0,t.jsx)(n.h3,{id:"deploy-to-phala-cloud",children:"Deploy to Phala Cloud"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Create and deploy a CVM\nelizaos tee phala cvms create --name elizaos -c <docker-compose-file> -e <path-to-env>\n"})}),"\n",(0,t.jsx)(n.h3,{id:"upgrade-agent-in-phala-cloud",children:"Upgrade Agent in Phala Cloud"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"elizaos tee phala cvms upgrade -c <docker-compose-file> -e <path-to-env-(optional)>\n"})}),"\n",(0,t.jsx)(n.h3,{id:"get-agents-remote-attestation-report",children:"Get Agent's Remote Attestation Report"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"elizaos tee phala cvms attestation <app-id>\n"})}),"\n",(0,t.jsx)(n.h2,{id:"local-development",children:"Local Development"}),"\n",(0,t.jsx)(n.p,{children:"To get a TEE simulator for local testing, use the following commands:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Start the simulator\nelizaos tee phala simulator start\n# Run your docker compose file\ndocker compose up\n"})}),"\n",(0,t.jsx)(n.h2,{id:"dependencies",children:"Dependencies"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"@phala/dstack-sdk"}),": Core TEE functionality"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"@solana/web3.js"}),": Solana blockchain interaction"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"viem"}),": Ethereum interaction library"]}),"\n",(0,t.jsx)(n.li,{children:"Other standard dependencies listed in package.json"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"api-reference",children:"API Reference"}),"\n",(0,t.jsx)(n.h3,{id:"actions",children:"Actions"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"phalaRemoteAttestationAction"}),": Action to generate a remote attestation report on the processed message and upload the attestation report to ",(0,t.jsx)(n.a,{href:"https://proof.t16z.com",children:"https://proof.t16z.com"})]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"providers",children:"Providers"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"deriveKeyProvider"}),": Manages secure key derivation within TEE"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"remoteAttestationProvider"}),": Handles generation of remote attestation quotes"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"walletProvider"}),": Manages wallet interactions with TEE-derived keys"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"services",children:"Services"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"TEEService"}),": Service to use the key generation functions to generate keys for EVM or Solana based blockchains"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"types",children:"Types"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"enum TEEMode {\n  OFF = 'OFF',\n  LOCAL = 'LOCAL', // For local development with simulator\n  DOCKER = 'DOCKER', // For docker development with simulator\n  PRODUCTION = 'PRODUCTION', // For production without simulator\n}\n\ninterface RemoteAttestationQuote {\n  quote: string;\n  timestamp: number;\n}\n"})}),"\n",(0,t.jsx)(n.h2,{id:"future-enhancements",children:"Future Enhancements"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Key Management"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Advanced key derivation schemes"}),"\n",(0,t.jsx)(n.li,{children:"Multi-party computation support"}),"\n",(0,t.jsx)(n.li,{children:"Key rotation automation"}),"\n",(0,t.jsx)(n.li,{children:"Backup and recovery systems"}),"\n",(0,t.jsx)(n.li,{children:"Hardware security module integration"}),"\n",(0,t.jsx)(n.li,{children:"Custom derivation paths"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Remote Attestation"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Enhanced quote verification"}),"\n",(0,t.jsx)(n.li,{children:"Multiple TEE provider support"}),"\n",(0,t.jsx)(n.li,{children:"Automated attestation renewal"}),"\n",(0,t.jsx)(n.li,{children:"Policy management system"}),"\n",(0,t.jsx)(n.li,{children:"Compliance reporting"}),"\n",(0,t.jsx)(n.li,{children:"Audit trail generation"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Security Features"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Memory encryption improvements"}),"\n",(0,t.jsx)(n.li,{children:"Side-channel protection"}),"\n",(0,t.jsx)(n.li,{children:"Secure state management"}),"\n",(0,t.jsx)(n.li,{children:"Access control systems"}),"\n",(0,t.jsx)(n.li,{children:"Threat detection"}),"\n",(0,t.jsx)(n.li,{children:"Security monitoring"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Chain Integration"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Multi-chain support expansion"}),"\n",(0,t.jsx)(n.li,{children:"Cross-chain attestation"}),"\n",(0,t.jsx)(n.li,{children:"Chain-specific optimizations"}),"\n",(0,t.jsx)(n.li,{children:"Custom signing schemes"}),"\n",(0,t.jsx)(n.li,{children:"Transaction privacy"}),"\n",(0,t.jsx)(n.li,{children:"Bridge security"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Developer Tools"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Enhanced debugging capabilities"}),"\n",(0,t.jsx)(n.li,{children:"Testing framework"}),"\n",(0,t.jsx)(n.li,{children:"Simulation environment"}),"\n",(0,t.jsx)(n.li,{children:"Documentation generator"}),"\n",(0,t.jsx)(n.li,{children:"Performance profiling"}),"\n",(0,t.jsx)(n.li,{children:"Integration templates"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Performance Optimization"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Parallel processing"}),"\n",(0,t.jsx)(n.li,{children:"Caching mechanisms"}),"\n",(0,t.jsx)(n.li,{children:"Resource management"}),"\n",(0,t.jsx)(n.li,{children:"Latency reduction"}),"\n",(0,t.jsx)(n.li,{children:"Throughput improvements"}),"\n",(0,t.jsx)(n.li,{children:"Load balancing"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"We welcome community feedback and contributions to help prioritize these enhancements."}),"\n",(0,t.jsx)(n.h2,{id:"contributing",children:"Contributing"}),"\n",(0,t.jsx)(n.p,{children:"Contributions are welcome! Please see the CONTRIBUTING.md file for more information."}),"\n",(0,t.jsx)(n.h2,{id:"credits",children:"Credits"}),"\n",(0,t.jsx)(n.p,{children:"This plugin integrates with and builds upon several key technologies:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"https://cloud.phala.network/",children:"Phala Cloud"}),": TEE Cloud Hosting Platform built by Phala Network"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"https://www.npmjs.com/package/@phala/dstack-sdk",children:"@phala/dstack-sdk"}),": dstack SDK for key generation and remote attestation function calls"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"https://www.npmjs.com/package/@solana/web3.js",children:"@solana/web3.js"}),": Solana blockchain interaction"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"https://www.npmjs.com/package/viem",children:"viem"}),": Ethereum interaction library"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"https://deepwiki.com/Dstack-TEE/dstack",children:"Dstack Deep Wiki"}),": dstack is a developer-friendly platform designed to simplify the deployment of containerized applications into Trusted Execution Environments (TEEs)"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Special thanks to:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"The Phala Network team for their TEE infrastructure"}),"\n",(0,t.jsx)(n.li,{children:"The Intel SGX/TDX team for TEE technology"}),"\n",(0,t.jsx)(n.li,{children:"The dstack SDK maintainers"}),"\n",(0,t.jsx)(n.li,{children:"The Eliza community for their contributions and feedback"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"For more information about TEE capabilities:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://docs.phala.network/",children:"Phala Documentation"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://docs.phala.network/phala-cloud/be-production-ready",children:"Phala Cloud Production Ready"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://docs.phala.network/developers/dstack-sdk",children:"dstack SDK Reference"})}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"license",children:"License"}),"\n",(0,t.jsx)(n.p,{children:"This plugin is part of the Eliza project. See the main project repository for license information."})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},71184:(e,n,i)=>{i.d(n,{R:()=>a,x:()=>s});var r=i(14041);const t={},l=r.createContext(t);function a(e){const n=r.useContext(l);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),r.createElement(l.Provider,{value:n},e.children)}}}]);